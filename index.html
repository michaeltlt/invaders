<!DOCTYPE html>
<html>
<head>
    <script src="js/phaser.min.js"></script>
</head>
<body>

    <script>
    // var doc_width = document.width;
    // var doc_height = document.height;
    var config = {
        type: Phaser.AUTO,
        width: 800,
        height: 600,
        physics: {
            default: 'arcade',
            arcade: {
                debug: true
            }
        },
        scene: {
            preload: preload,
            create: create,
            update: update
        }
    };

    var game = new Phaser.Game(config);
    var score = 0;
    var scoreText;
    var player;
    var cursors;

    function preload()
    {
        this.load.setBaseURL('.');

        this.load.image('space', 'assets/background.png');
        this.load.image('ship', 'assets/ship.png');
        this.load.image('enemy', 'assets/enemy.png');
    }

    function create()
    {
        cursors = this.input.keyboard.createCursorKeys();

        this.add.image(400, 300, 'space');

        player = this.physics.add.image(400, 570, 'ship');
        player.setCollideWorldBounds(true);

        // this.physics.enable(player, Phaser.Physics.ARCADE);

        // this.add.image(400, 570, 'ship');
        let enemies = createEnemies(this);
        
       
        // var particles = this.add.particles('red');

        // var emitter = particles.createEmitter({
        //     speed: 100,
        //     scale: { start: 1, end: 0 },
        //     blendMode: 'ADD'
        // });

        // var logo = this.physics.add.image(400, 100, 'logo');

        // logo.setVelocity(100, 200);
        // logo.setBounce(1, 1);
        // logo.setCollideWorldBounds(true);

        // emitter.startFollow(logo);

        // fireButton = this.input.keyboard.addKey(Phaser.KeyCode.SPACEBAR);
    }

    function createEnemies(context) {
        let enemies = context.physics.add.staticGroup();

        let startX = 170, startY = 100, step = 14;

        for(let i = 0; i < 11; i++) {
            for(let j = 0; j < 5; j++) {
                enemies.create(startX + i * (32 + step), startY + j * (26 + step), 'enemy');
            }
        }

        enemies.x = startX;
        enemies.y = startY;

        //  All this does is basically start the invaders moving. Notice we're moving the Group they belong to, rather than the invaders directly.
        var tween = context.add.tween(enemies).to( { x: 200 }, 2000, Phaser.Math.Easing.Linear.None, true, 0, 1000, true);

        //  When the tween loops it calls descend
        // tween.onLoop.add(function() { enemies.y += 10; }, context);

        return enemies;
    }

    // function descend() {
    //     enemies.y += 10;
    // }


    function update() {
        if (cursors.left.isDown)
        {
            console.log('Left');
            player.setX(player.x - 10);
        }
        else if (cursors.right.isDown)
        {
            console.log('Right');
            player.setX(player.x + 10);
        }

        //  Firing?
        // if (fireButton.isDown)
        // {
        //     // fireBullet();
        // }
    }
    </script>

</body>
</html>